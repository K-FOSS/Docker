#!/bin/sh
ENV_FILE=".env"
VOLUME_NAME=""
COMPOSE_FILE="docker-compose.yml"
DOCKER_IMAGE="kristianfoss/programs-docker:docker-cli-stable-scratch"

# Author bmmuller
# Source: https://gist.github.com/judy2k/7656bfe3b322d669ef75364a46327836#gistcomment-3239799
function export_envs() {
  local envFile=${1:-.env}
  while IFS='=' read -r key temp || [ -n "$key" ]; do
    local isComment='^[[:space:]]*#'
    local isBlank='^[[:space:]]*$'
    [[ $key =~ $isComment ]] && continue
    [[ $key =~ $isBlank ]] && continue
    value=$(eval echo "$temp")
    eval export "$key='$value'";
  done < $envFile
}

function error_exit() {
	echo "$1" 1>&2
	exit 1
}

# Get env variables from .env
export_envs ${ENV_FILE}

SOCKET_VOLUME_NAME="${DEVELOPMENT_NAME}-socket"


docker run -it --rm -v ${SOCKET_VOLUME_NAME}:/var/run ${DOCKER_IMAGE} images
docker run -it --rm -v ${SOCKET_VOLUME_NAME}:/var/run ${DOCKER_IMAGE} run -it --rm hello-world